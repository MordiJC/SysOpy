DEBUG = 0

SANITIZER = NONE

ifeq ($(SANITIZER),ADDRESS)

SANITIZER_FLAGS = -fsanitize=address
SANITIZER_LIBS = -lasan

else ifeq ($(SANITIZER),UNDEFINED)

SANITIZER_FLAGS = -fsanitize=undefined
SANITIZER_LIBS = -lubsan

else ifeq ($(SANITIZER),LEAK)

SANITIZER_FLAGS = -fsanitize=leak
SANITIZER_LIBS = 

else ifeq ($(SANITIZER),THREAD)

SANITIZER_FLAGS = -fsanitize=thread
SANITIZER_LIBS = -ltsan

endif

ifeq ($(DEBUG),1)

DEBUG_FLAGS = -g -O0

else

DEBUG_FLAGS = -O2

endif

CC = gcc 
CFLAGS = --std=c11 -Wall -Wextra -fPIC -pedantic -Wall \
	-Wno-missing-braces -Wextra -Wno-missing-field-initializers -Wformat=2 \
	-Wswitch-default -Wswitch-enum -Wcast-align -Wpointer-arith \
	-Wbad-function-cast -Wstrict-overflow=5 -Wstrict-prototypes -Winline \
	-Wundef -Wnested-externs -Wcast-qual -Wshadow -Wunreachable-code \
	-Wlogical-op -Wfloat-equal -Wredundant-decls \
	-Wold-style-definition -Werror \
	-fno-omit-frame-pointer -ffloat-store -fno-common \
	$(SANITIZER_FLAGS) $(DEBUG_FLAGS) $(MYFLAGS)
LDFLAGS = $(SANITIZER_LIBS) -lpthread -lm
RM = rm -r
ECHO = echo -e

COMMONS = 

SERVER = server
SERVER_CORE_O = server.o $(COMMONS)

CLIENT = client
CLIENT_CORE_O = client.o $(COMMONS)

SERVER_REQ = $(SERVER_CORE_O)
CLIENT_REQ = $(CLIENT_CORE_O)

.PHONY: all

all: $(SERVER) $(CLIENT)

$(SERVER): $(SERVER_REQ)
	$(CC) $^ -o $@ $(LDFLAGS)

$(CLIENT): $(CLIENT_REQ)
	$(CC) $^ -o $@ $(LDFLAGS)

.PHONY: clean

clean:
	$(RM) ./*.o ./$(SERVER) ./$(CLIENT)

.PHONY: depend

depend:
	$(CC) -MM ./*.c


# Generated by `depend'
server.o: server.c common.h